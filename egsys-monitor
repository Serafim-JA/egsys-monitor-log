#!/usr/bin/env python3
"""egSYS Monitor - Launcher Principal"""

import os
import sys
from pathlib import Path

# Define diret√≥rios
if os.path.exists(os.path.expanduser('~/.egsys-monitor')):
    PROJECT_ROOT = Path.home() / '.egsys-monitor'
else:
    PROJECT_ROOT = Path(__file__).parent

# Adiciona src ao path
sys.path.insert(0, str(PROJECT_ROOT / 'src'))

# Importa m√≥dulos
try:
    from login import authenticate
    from log_monitor import main_menu
except ImportError as e:
    print(f"\033[1;31m‚ùå Erro ao importar m√≥dulos: {e}\033[0m")
    print(f"\033[1;33mPROJECT_ROOT: {PROJECT_ROOT}\033[0m")
    sys.exit(1)

def show_banner():
    print("\033[2J\033[H")  # Clear screen
    print("\033[1;36m" + "=" * 60 + "\033[0m")
    print("\033[1;36m" + " " * 18 + "egSYS Monitor v1.0" + " " * 24 + "\033[0m")
    print("\033[1;36m" + "=" * 60 + "\033[0m")
    print()

def main():
    show_banner()
    
    # Autentica√ß√£o
    if not authenticate():
        print("\n\033[1;31m‚ùå Falha na autentica√ß√£o\033[0m")
        sys.exit(1)
    
    # Inicia monitor
    try:
        main_menu()
    except KeyboardInterrupt:
        print("\n\n\033[1;33müëã At√© logo!\033[0m")
        sys.exit(0)
    except Exception as e:
        print(f"\n\033[1;31m‚ùå Erro: {e}\033[0m")
        sys.exit(1)

if __name__ == "__main__":
    main()
